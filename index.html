<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>일본어 학습 (made by jw)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Pretendard', 'Noto Sans JP', 'sans-serif'],
                    },
                    colors: {
                        indigo: { 50: '#eef2ff', 100: '#e0e7ff', 500: '#6366f1', 600: '#4f46e5', 700: '#4338ca' }
                    }
                },
            },
        }
    </script>

    <style>
        /* 중요: iOS Safari 주소창 대응을 위한 높이 설정 */
        body { 
            overscroll-behavior: none;
            height: 100vh; /* 구형 브라우저용 */
            height: 100dvh; /* 모바일 브라우저 주소창 대응 (Dynamic Viewport Height) */
        }
        
        /* 아이폰 하단 홈 바(Home Indicator) 영역 여백 처리 */
        .pb-safe {
            padding-bottom: constant(safe-area-inset-bottom); /* iOS 11.0 */
            padding-bottom: env(safe-area-inset-bottom); /* iOS 11.2+ */
        }

        /* 메뉴 카드 호버 효과 */
        .menu-card {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .menu-card:active {
            transform: scale(0.98);
        }
        @media (hover: hover) {
            .menu-card:hover {
                transform: translateY(-3px);
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
                border-color: #818cf8;
            }
        }

        /* 스크롤바 커스텀 */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
        
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body class="bg-gray-100 h-[100dvh] flex flex-col font-sans text-gray-800 overflow-hidden">

    <div id="main-content" class="flex-grow flex flex-col h-full overflow-hidden relative">
        
        <div id="main-menu" class="flex-grow flex flex-col h-full overflow-y-auto custom-scrollbar">
            <header class="bg-white shadow-sm sticky top-0 z-50 flex-shrink-0">
                <div class="container mx-auto max-w-5xl px-6 py-6 text-center sm:text-left flex flex-col sm:flex-row justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-extrabold text-gray-900 tracking-tight">일본어 학습</h1>
                        <p class="text-indigo-600 font-bold text-lg mt-1 tracking-wider">日本語学習</p>
                    </div>
                </div>
            </header>

            <main class="flex-grow container mx-auto max-w-5xl p-6 pb-6">
                
                <div class="mb-10">
                    <h2 class="text-xl font-bold text-gray-700 mb-4 flex items-center">
                        <span class="w-2 h-8 bg-indigo-500 rounded-full mr-3"></span>
                        단어장 <span class="text-sm text-gray-400 font-normal ml-2">単語帳</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div onclick="openApp('voca_list.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-indigo-100 p-3 rounded-xl text-indigo-600 mr-4 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-indigo-600 transition-colors">전체 단어장</h3>
                                <p class="text-gray-500 text-sm mt-1">단어 목록을 한눈에 보고 관리합니다.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-10">
                    <h2 class="text-xl font-bold text-gray-700 mb-4 flex items-center">
                        <span class="w-2 h-8 bg-blue-500 rounded-full mr-3"></span>
                        플래시카드 <span class="text-sm text-gray-400 font-normal ml-2">フラッシュ・カード</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div onclick="openApp('voca_flash.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-blue-100 p-3 rounded-xl text-blue-600 mr-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-blue-600 transition-colors">단어 플래시카드</h3>
                                <p class="text-gray-500 text-sm mt-1">저장된 단어장 파일 기반 플래시카드 학습</p>
                            </div>
                        </div>
                        <div onclick="openApp('voca_flash_custom.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-cyan-100 p-3 rounded-xl text-cyan-600 mr-4 group-hover:bg-cyan-600 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-cyan-600 transition-colors">나만의 플래시카드</h3>
                                <p class="text-gray-500 text-sm mt-1">입력한 단어로 플래시카드 학습</p>
                            </div>
                        </div>
                        <div onclick="openApp('voca_flash_timer.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-sky-100 p-3 rounded-xl text-sky-600 mr-4 group-hover:bg-sky-600 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-sky-600 transition-colors">단어 플래시카드 (타이머)</h3>
                                <p class="text-gray-500 text-sm mt-1">자동으로 넘어가는 타이머 모드</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-10">
                    <h2 class="text-xl font-bold text-gray-700 mb-4 flex items-center">
                        <span class="w-2 h-8 bg-green-500 rounded-full mr-3"></span>
                        퀴즈 <span class="text-sm text-gray-400 font-normal ml-2">クイズ</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div onclick="openApp('voca_quiz.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-green-100 p-3 rounded-xl text-green-600 mr-4 group-hover:bg-green-600 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-green-600 transition-colors">단어 퀴즈</h3>
                                <p class="text-gray-500 text-sm mt-1">5지 선다형 객관식 테스트</p>
                            </div>
                        </div>
                        <div onclick="openApp('voca_quiz_custom.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-teal-100 p-3 rounded-xl text-teal-600 mr-4 group-hover:bg-teal-600 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-teal-600 transition-colors">나만의 단어 퀴즈</h3>
                                <p class="text-gray-500 text-sm mt-1">입력한 단어로 5지 선다형 객관식 테스트</p>
                            </div>
                        </div>
                        <div onclick="openApp('romaji_test.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-emerald-100 p-3 rounded-xl text-emerald-600 mr-4 group-hover:bg-emerald-500 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 0 1 6-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 0 1-3.827-5.802" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-emerald-600 transition-colors">가나 문자 찾기 퀴즈</h3>
                                <p class="text-gray-500 text-sm mt-1">로마자를 보고 가나를 찾는 기초 테스트</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-10">
                    <h2 class="text-xl font-bold text-gray-700 mb-4 flex items-center">
                        <span class="w-2 h-8 bg-orange-500 rounded-full mr-3"></span>
                        가나 & 간지 <span class="text-sm text-gray-400 font-normal ml-2">かな & 漢字</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div onclick="openApp('kana_chart.html')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-orange-100 p-3 rounded-xl text-orange-600 mr-4 group-hover:bg-orange-500 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-orange-600 transition-colors">히라가나 / 가타카나</h3>
                                <p class="text-gray-500 text-sm mt-1">히라가나・가타카나 (ひらがな・カタカナ) 50음도</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-10">
                    <h2 class="text-xl font-bold text-gray-700 mb-4 flex items-center">
                        <span class="w-2 h-8 bg-rose-500 rounded-full mr-3"></span>
                        즐겨찾기 <span class="text-sm text-gray-400 font-normal ml-2">ブックマーク</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        
                        <div onclick="openApp('https://ja.dict.naver.com/')" class="menu-card bg-white rounded-2xl p-6 shadow-md border border-transparent flex items-start group cursor-pointer">
                            <div class="bg-rose-100 p-3 rounded-xl text-rose-600 mr-4 group-hover:bg-rose-500 group-hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 group-hover:text-rose-600 transition-colors">네이버 일본어사전</h3>
                                <p class="text-gray-500 text-sm mt-1">Naver Japanese Dictionary</p>
                            </div>
                        </div>
                    </div>
                </div>

            </main>

            <footer class="bg-white border-t py-8 mt-auto flex-shrink-0">
                <div class="container mx-auto text-center text-gray-400 text-sm">
                    <p>made by jw</p>
                </div>
            </footer>
        </div>

        <div id="iframe-container" class="absolute inset-0 z-40 bg-white hidden flex-col">
            <iframe id="app-frame" name="app-frame" src=""></iframe>
        </div>

    </div>

    <nav id="nav-bar" class="bg-white border-t border-gray-200 flex-shrink-0 pb-safe z-50">
        <div class="grid grid-cols-7 h-16">
            
            <button onclick="goBack()" class="flex flex-col items-center justify-center text-gray-500 hover:text-gray-800 active:text-black transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-7 h-7 group-active:scale-90 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
                </svg>
            </button>

            <button onclick="goHome()" class="flex flex-col items-center justify-center text-gray-500 hover:text-indigo-600 active:text-indigo-700 transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mb-1 group-active:scale-90 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                </svg>
                <span class="text-[10px] font-medium">홈</span>
            </button>

            <button onclick="openApp('voca_list.html')" class="flex flex-col items-center justify-center text-gray-500 hover:text-indigo-600 active:text-indigo-700 transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mb-1 group-active:scale-90 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                </svg>
                <span class="text-[10px] font-medium">단어장</span>
            </button>

            <button onclick="openApp('voca_flash.html')" class="flex flex-col items-center justify-center text-gray-500 hover:text-blue-600 active:text-blue-700 transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mb-1 group-active:scale-90 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6" />
                </svg>
                <span class="text-[10px] font-medium">암기</span>
            </button>

            <button onclick="openApp('voca_quiz.html')" class="flex flex-col items-center justify-center text-gray-500 hover:text-green-600 active:text-green-700 transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mb-1 group-active:scale-90 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
                <span class="text-[10px] font-medium">퀴즈</span>
            </button>

            <button onclick="openApp('https://ja.dict.naver.com/')" class="flex flex-col items-center justify-center text-gray-500 hover:text-green-500 active:text-green-600 transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mb-1 group-active:scale-90 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                </svg>
                <span class="text-[10px] font-medium">사전</span>
            </button>
            
            <button onclick="goForward()" class="flex flex-col items-center justify-center text-gray-500 hover:text-gray-800 active:text-black transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-7 h-7 group-active:scale-90 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                </svg>
            </button>

        </div>
    </nav>

    <script>
        const mainMenu = document.getElementById('main-menu');
        const iframeContainer = document.getElementById('iframe-container');
        const appFrame = document.getElementById('app-frame');

        // 히스토리 관리 변수 (자체 스택)
        let historyStack = [{ type: 'home' }];
        let currentIndex = 0;

        // 앱 열기 (히스토리 추가)
        function openApp(url) {
            // 현재 위치 이후의 히스토리는 삭제 (새로운 경로 시작)
            if (currentIndex < historyStack.length - 1) {
                historyStack = historyStack.slice(0, currentIndex + 1);
            }
            
            // 새 상태 추가
            historyStack.push({ type: 'app', url: url });
            currentIndex++;
            
            // 뷰 업데이트
            updateView();
        }

        // 홈으로 가기 (히스토리 추가)
        function goHome() {
            if (currentIndex < historyStack.length - 1) {
                historyStack = historyStack.slice(0, currentIndex + 1);
            }
            
            // 홈 상태 추가 (이미 홈이 아닐 경우에만)
            if (historyStack[currentIndex].type !== 'home') {
                historyStack.push({ type: 'home' });
                currentIndex++;
            }
            
            updateView();
        }

        // 뒤로 가기
        function goBack() {
            if (currentIndex > 0) {
                currentIndex--;
                updateView();
            } else {
                // 더 이상 뒤로 갈 곳이 없으면 (선택 사항: 경고 or 무반응)
                // console.log('No more history back');
            }
        }

        // 앞으로 가기
        function goForward() {
            if (currentIndex < historyStack.length - 1) {
                currentIndex++;
                updateView();
            } else {
                // console.log('No more history forward');
            }
        }

        // 현재 상태에 따라 화면(DOM) 업데이트
        function updateView() {
            const currentState = historyStack[currentIndex];

            if (currentState.type === 'home') {
                // 홈 화면 표시
                iframeContainer.classList.add('hidden');
                mainMenu.classList.remove('hidden');
                
                // 리소스 해제
                setTimeout(() => {
                    // 현재 홈 상태일 때만 초기화 (비동기 이슈 방지)
                    if (historyStack[currentIndex].type === 'home') {
                         appFrame.src = 'about:blank'; 
                    }
                }, 100);

            } else if (currentState.type === 'app') {
                // 앱 화면 표시
                mainMenu.classList.add('hidden');
                iframeContainer.classList.remove('hidden');
                
                // URL이 변경되었을 때만 로드 (불필요한 리로드 방지)
                // 단, about:blank 상태이거나 다른 URL이면 로드
                const currentSrc = appFrame.getAttribute('src');
                if (!currentSrc || currentSrc === 'about:blank' || !currentSrc.endsWith(currentState.url)) {
                    appFrame.src = currentState.url;
                }
            }
        }

        // 초기 로드 설정
        document.addEventListener('DOMContentLoaded', () => {
            // 초기 상태는 'home' (historyStack[0])
            updateView();
        });
    </script>
</body>
</html>
